
# Running Pure Pursuit on the F1Tenth AV

(Using Waypoints Generated by the Optimal Trajectory Generator)

This document provides a complete guide to running the Pure Pursuit (PP) algorithm on an actual F1Tenth AV when using waypoint files generated by the **Optimal Trajectory Generator (wp_gen.py)**.

---

## üì¶ Prerequisites

### 1. Prepare the Map and Map Configuration Files

* Use **SLAM Toolbox** to generate the map files in `.pgm` and `.yaml` formats.

### 2. Generate WP Files Using the Optimal Trajectory Generator

* Follow the tutorial:
  **[How to Generate WP Using the Optimal Trajectory Generator](https://github.com/jinkimh/f1tenth_bootcamp/blob/main/7-1-Tutorial_Trajectory_Generator.md)**

### 3. Configure the Particle Filter

* Copy the generated map (`.pgm` + `.yaml`) to:

```text
particle_filter/maps/
```

* Then, open the following configuration file and update the map name:

```bash
particle_filter/config/localize.yaml
```

---

## üöò Download the Driving Algorithms

*Skip this step if `~/f1tenth_ws/src/f1tenth-software-stack` already exists.*

```bash
cd ~/f1tenth_ws/src
git clone https://github.com/jinkimh/f1tenth-software-stack.git
```

---

## ‚öôÔ∏è Modify the Pure Pursuit Node Settings

Open the PP node:

```bash
~/f1tenth_ws/src/f1tenth-software-stack/pure_pursuit/scripts/pure_pursuit_node.py
```

### Required Modification:

| Line | Code                   | Description                                   |
| ---- | ---------------------- | --------------------------------------------- |
| 25   | `self.is_real = False` | Set to `True` when running on the **real AV** |

---

## üìÅ Copy the Waypoint CSV File

```bash
cp your_waypoints.csv ~/f1tenth_ws/src/f1tenth-software-stack/csv_data/
```

> The file `your_waypoints.csv` must be generated based on the SLAM map and the trajectory generator output.

---

## ‚ñ∂Ô∏è Execution Sequence

### 1. Run Teleop (Terminal 1)

```bash
cd ~/f1tenth_ws/
source /opt/ros/foxy/setup.bash
source install/setup.bash
ros2 launch f1tenth_stack bringup_launch
```

---

### 2. Run RViz (Terminal 2)

```bash
source /opt/ros/foxy/setup.bash
rviz2
```

---

### 3. Run Particle Filter (Terminal 3)

```bash
cd ~/f1tenth_ws/
source /opt/ros/foxy/setup.bash
source install/setup.bash
ros2 launch particle_filter localize_launch.py
```

After launching, use the **‚Äú2D Pose Estimate‚Äù** button in RViz to set the vehicle‚Äôs approximate initial pose on the map.

---

### 4. Run Pure Pursuit (Terminal 4)

```bash
cd ~/f1tenth_ws/
source /opt/ros/foxy/setup.bash
source install/setup.bash
ros2 run pure_pursuit pure_pursuit_node.py
```

---

## ‚úÖ Notes & Recommendations

* In `pure_pursuit_node.py`, the `is_real` flag must be set correctly.

  * `True`  ‚Üí real F1Tenth AV
  * `False` ‚Üí simulation mode
* You **must** set the initial particle filter pose using the RViz tool **‚Äú2D Pose Estimate‚Äù**.
* The map name and the waypoint filename must be consistent across:

  * Particle Filter configuration
  * Pure Pursuit node
  * CSV file placement
* The waypoint `.csv` format must follow the expected structure used by the Pure Pursuit implementation.

---

## üìÑ Copyright

```text
¬© 2025 Jin Kim, Gyeongsang National University

This document was created for experimental and educational use with the F1Tenth autonomous driving platform.
Unauthorized reproduction and commercial use are prohibited.
```

---
